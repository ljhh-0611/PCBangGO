package com.example.capstone2.pcbanggo;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;

/**
 * Created by Jeff on 2016-11-09.
 */

public class PCroomDBHelper extends SQLiteOpenHelper {

    String TABLE_NAME = "pc_seat";
    String KEY_PCROOM = "name";
    String KEY_ROW = "row";
    String KEY_COL = "col";
    String KEY_SEATMAP = "seat_map";
    String KEY_ORIENT = "seat_orient";
    String KEY_CANSEAT = "can_seat";

    public PCroomDBHelper(Context context){super(context,"pcpc.db",null,3);}

    @Override
    public void onCreate(SQLiteDatabase sqLiteDatabase) {
        String query = String.format(
                "CREATE TABLE %s ("
                        + "_id INTEGER PRIMARY KEY AUTOINCREMENT, " +
                        "%s TEXT, " +
                        "%s INTEGER, " +
                        "%s INTEGER, " +
                        "%s TEXT, " +
                        "%s TEXT, " +
                        "%s TEXT);", TABLE_NAME, KEY_PCROOM, KEY_ROW, KEY_COL, KEY_SEATMAP, KEY_ORIENT, KEY_CANSEAT );
        sqLiteDatabase.execSQL( query );

        String[] PCrooms = {"'3POP'","'Gallery'", "'Max'","'Choice'","'Red'"};
        int[] rows = {22, 9, 9, 13, 13};
        int[] cols = {17, 22, 18, 10, 12};

        String[] seats = {"'0 97 0 96 81 0 80 72 0 71 54 0 53 40 0 39 26 0 25 10 0 9 " +
                        "0 98 0 95 82 0 79 73 0 70 55 0 52 41 0 38 27 0 24 11 0 8 " +
                        "0 99 0 94 83 0 78 74 0 69 56 0 51 42 0 37 28 0 23 12 0 7 " +
                        "0 100 0 93 84 0 77 0 0 68 57 0 50 43 0 0 29 0 22 13 0 6 " +
                        "0 101 0 92 85 0 0 0 0 67 58 0 49 44 0 0 30 0 21 14 0 5 " +
                        "0 102 0 91 86 0 0 0 0 66 59 0 48 45 0 36 31 0 20 15 0 4 " +
                        "0 103 0 90 87 0 0 0 0 65 60 0 47 46 0 35 32 0 19 16 0 3 " +
                        "0 104 0 89 88 0 0 0 0 0 0 0 0 0 0 34 33 0 18 17 0 2 " +
                        "0 105 0 0 0 0 0 75 0 63 62 0 140 0 0 0 0 0 0 0 0 1 " +
                        "0 0 0 0 0 0 0 76 0 64 61 0 139 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 106 107 108 109 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "116 115 114 113 112 111 110 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "117 118 119 120 121 122 123 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "130 129 128 127 126 125 124 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "131 132 133 134 135 136 137 138 0 0 0 0 0 0 0 0 0 0 0 0 0 0'",
                //////////////////////////////////////////////////////////
                "'0 0 0 6 5 4 3 2 1 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 7 8 9 10 11 12 "+
                        "0 0 0 17 16 15 14 13 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 18 19 20 21 22 23 "+
                        "0 0 0 28 27 25 26 24 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 29 30 31 32 33 34 "+
                        "0 0 0 39 38 37 36 35 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 40 41 42 43 44 45 "+
                        "87 86 0 51 50 49 48 47 46 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "84 85 0 52 53 54 55 56 57 "+
                        "83 82 0 62 61 60 59 58 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "80 81 0 63 64 65 66 67 68 "+
                        "79 78 0 73 72 71 70 69 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "76 77 0 0 0 0 0 0 0 "+
                        "75 74 0 0 0 0 0 0 0'",
                ///////////////////////////////////////////////////////////
                "'73 72 71 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "70 69 68 67 66 65 0 0 0 "+
                        "64 63 62 61 60 59 0 0 0 "+
                        "0 0 0 0 0 0 0 0 0 " +
                        "58 57 56 55 54 53 0 0 0 " +
                        "52 51 50 49 48 47 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "46 45 44 43 42 0 0 0 0 " +
                        "41 40 39 38 37 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "36 35 34 33 32 31 0 0 0 " +
                        "0 30 29 28 27 26 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "22 0 17 11 0 1 2 3 4 " +
                        "23 0 18 12 0 0 0 0 0 " +
                        "24 0 19 13 0 0 5 6 7 " +
                        "25 0 20 14 0 0 8 9 10'",
                ////////////////////////////////////////////////////////////
                "'2 0 0 55 56 0 15 24 0 33 42 0 0 " +
                        "1 0 0 0 0 0 14 23 0 32 41 0 51 "+
                        "0 0 52 53 54 0 13 22 0 31 40 0 50 "+
                        "0 0 0 0 0 0 12 21 0 30 39 0 49 "+
                        "0 0 0 0 0 0 0 0 0 0 0 0 48 "+
                        "0 0 0 0 0 0 11 20 0 29 38 0 47 "+
                        "0 0 0 0 6 0 10 19 0 28 37 0 46 "+
                        "0 0 0 0 5 0 9 18 0 27 36 0 45 "+
                        "0 0 0 0 4 0 8 17 0 26 35 0 44 " +
                        "0 0 0 0 3 0 7 16 0 25 34 0 43'",
                //////////////////////////////////////////////////////////
                "'10 9 8 7 6 0 5 4 3 2 1 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "11 12 13 14 15 0 53 54 0 69 0 0 0 " +
                        "20 19 18 17 16 0 52 55 0 68 0 0 0 " +
                        "0 0 0 0 0 0 51 56 0 67 0 0 0 " +
                        "21 22 23 24 25 0 50 57 0 66 70 0 0 " +
                        "30 29 28 27 26 0 49 58 0 65 71 0 79 " +
                        "0 0 0 0 0 0 48 59 0 64 72 0 78 " +
                        "31 32 33 34 35 0 47 60 0 63 73 0 77 " +
                        "0 39 38 37 36 0 46 61 0 62 74 0 76 " +
                        "0 0 0 0 0 0 0 0 0 0 75 0 0 " +
                        "40 41 42 43 44 45 0 0 0 0 0 0 0'"};

        String[] orient = {"'0 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 2 0 0 2 2 0 2 2 0 0 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 0 0 0 2 2 0 2 2 0 0 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 0 0 0 2 2 0 2 2 0 2 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 0 0 0 2 2 0 2 2 0 2 2 0 2 2 0 2 " +
                        "0 2 0 2 2 0 0 0 0 0 0 0 0 0 0 2 2 0 2 2 0 2 " +
                        "0 2 0 0 0 0 0 2 0 2 2 0 2 0 0 0 0 0 0 0 0 2 " +
                        "0 0 0 0 0 0 0 2 0 2 2 0 2 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0'",
                ////////////////////////////////////////
                "'0 0 0 1 1 1 1 1 1 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 1 1 1 1 1 1 "+
                        "0 0 0 1 1 1 1 1 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 1 1 1 1 1 1 "+
                        "0 0 0 1 1 1 1 1 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 1 1 1 1 1 1 "+
                        "0 0 0 1 1 1 1 1 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "0 0 0 1 1 1 1 1 1 "+
                        "1 1 0 1 1 1 1 1 1 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "1 1 0 1 1 1 1 1 1 "+
                        "1 1 0 1 1 1 1 1 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "1 1 0 1 1 1 1 1 1 "+
                        "1 1 0 1 1 1 1 1 0 "+
                        "0 0 0 0 0 0 0 0 0 "+
                        "1 1 0 0 0 0 0 0 0 "+
                        "1 1 0 0 0 0 0 0 0'",
                ////////////////////////////////////////
                "'1 1 1 0 0 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 0 0 0 "+
                        "1 1 1 1 1 1 0 0 0 "+
                        "0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 0 0 0 "+
                        "1 1 1 1 1 1 0 0 0 "+
                        "0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 0 0 0 0 "+
                        "1 1 1 1 1 0 0 0 0 " +
                        "0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 1 0 0 0 " +
                        "0 1 1 1 1 1 0 0 0 "+
                        "0 0 0 0 0 0 0 0 0 " +
                        "2 0 2 2 0 1 1 1 1 " +
                        "2 0 2 2 0 0 0 0 0 " +
                        "2 0 2 2 0 0 1 1 1 " +
                        "2 0 2 2 0 0 1 1 1'",
                //////////////////////////////////////////
                "'2 0 0 1 1 0 2 2 0 2 2 0 0 " +
                        "2 0 0 0 0 0 2 2 0 2 2 0 2 " +
                        "0 0 1 1 1 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 0 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 2 " +
                        "0 0 0 0 0 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 2 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 2 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 2 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 2 0 2 2 0 2 2 0 2'",
                //////////////////////////////////////////
                       "'1 1 1 1 1 0 1 1 1 1 1 0 0 " +
                        "0 0 0 0 0 0 0 0 0 0 0 0 0 " +
                        "1 1 1 1 1 0 2 2 0 2 0 0 0 " +
                        "1 1 1 1 1 0 2 2 0 2 0 0 0 " +
                        "0 0 0 0 0 0 2 2 0 2 0 0 0 " +
                        "1 1 1 1 1 0 2 2 0 2 2 0 0 " +
                        "1 1 1 1 1 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 0 0 2 2 0 2 2 0 2 " +
                        "1 1 1 1 1 0 2 2 0 2 2 0 2 " +
                        "0 1 1 1 1 0 2 2 0 2 2 0 2 " +
                        "0 0 0 0 0 0 0 0 0 0 2 0 0 " +
                        "1 1 1 1 1 1 0 0 0 0 0 0 0'"};
        String receive = "0:-116:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:0:"+
                "@1:87:0:0:0:8:-64:8:4:8:9:18:60:0:0:0:0:0:0:0:0:0:"+ // 갤러리 수정 필요!!
                "@2:73:38:17:-8:-57:15:-25:-17:-93:53:0:0:0:0:0:0:0:0:0:0:0:"+
                "@3:56:-124:51:33:14:68:0:21:0:0:0:0:0:0:0:0:0:0:0:0:0:"+
                "@4:79:17:-33:-39:-16:-8:118:-31:7:79:123:0:0:0:0:0:0:0:0:0:0:";
        String[] can_seats = {"'3POP'","'Gallery'", "'Max'","'Choice'","'Red'"};
        String[] cut_at = receive.split("@");
        for (int i=0;i < 5;i++) {
            String[] cut_colon = cut_at[i].split(":");
            int limit = Integer.parseInt(cut_colon[1]);
            if(limit < 0) limit &= 0xFF;
            StringBuilder buff = new StringBuilder();
            buff.append("'");
            int count = 0;
            int limit_col = limit/8+3;
            if (limit%8==0) limit_col--;
            for(int j=2;j<limit_col;j++) {
                byte seat = Byte.parseByte(cut_colon[j]);
                for(int k=7;k>=0;k--) {
                    if(count>=limit) break;
                    byte temp_seat = (byte) (seat>>>k);
                    buff.append((temp_seat & 1)+" ");
                    count ++;
                }
            }
            buff.deleteCharAt(buff.length()-1);
            buff.append("'");
            can_seats[i] = buff.toString();
        }

        for (int i=0;i<5;i++) {
            String insert = String.format(
                    "INSERT INTO %s VALUES (null, %s, %d, %d, %s, %s, %s);" ,TABLE_NAME , PCrooms[i], rows[i], cols[i],
                                                                seats[i], orient[i], can_seats[i]);
            /*String insert = "INSERT INTO pc_seat VALUES (null, '3POP', 6, 6, '1 2 3 0 4 5 6 7 8 0 9 10 0 0 0 0 0 0 11 14 0 17 18 19 12 15 0 20 21 22 13 16 0 0 0 0'," +
                    " '1 1 1 0 1 1 1 1 1 0 1 1 0 0 0 0 0 0 2 2 0 1 1 1 2 2 0 1 1 1 2 2 0 0 0 0', '0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0' );"; */
            sqLiteDatabase.execSQL(insert);
        }

    }

    @Override
    public void onUpgrade(SQLiteDatabase sqLiteDatabase, int oldVersion, int newVersion) {
        String query = String.format( "DROP TABLE IF EXISTS %s", TABLE_NAME );
        sqLiteDatabase.execSQL( query );
        onCreate( sqLiteDatabase );
    }
}

